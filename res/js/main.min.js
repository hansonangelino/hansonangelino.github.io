var jAlbumSettings=function(){window.$jAlbum=jQuery.noConflict(!0)}(),jAlbumLibrary=function(){function e(e){return e=e.substring(0,e.lastIndexOf("/")),e=e.substring(0,e.lastIndexOf("/")+1)}function t(e,t){return e=e.substring(0,e.lastIndexOf("/")+1),e+t+"/"}function o(e,t){return e.length>t?e.substring(0,t)+"...":e}function a(e,t){var o=$jAlbum("<img>");return o.prop("id",e),o.prop("src",t),o}function n(e,t){var o=$jAlbum("<video>");return o.prop("id",e),o.prop("src",t),o}function i(e){var t=new Image;t.src=e}function l(e){window.location.hash=e}function r(){return window.location.hash}return{previousDir:e,nextDir:t,truncate:o,img:a,vid:n,preloadImg:i,setHash:l,getHash:r}}(),jAlbumController=function(){function e(){return $jAlbum("#Responsive").width()}function t(){return $jAlbum(window).height()}function o(){return jAlbumGlobals.imgBoxSize/25*3+2*(16-jAlbumGlobals.textSize)-8}function a(){return jAlbumGlobals.mobile?15:25}function n(){return jAlbumGlobals.mobile?jAlbumGlobals.imgBoxSize-25:jAlbumGlobals.imgBoxSize}function i(e){var t=Math.round(e/y);return 1>t?1:t>jAlbumGlobals.maxImgInRow?jAlbumGlobals.maxImgInRow:t}function l(e){var t=void 0==e?"":e;""==G&&jAlbumGlobals.online&&history.pushState("",document.title,window.location.pathname),jAlbumLibrary.setHash(G+t)}function r(e){$jAlbum(".main-box").css({width:e+"px",height:e+"px"}),$jAlbum(".wrapper-box").css({width:e+"px",height:e+"px"})}function s(e,t){for(var o=0>e-t?0:e-t,a=e+t>L.length?L.length:e+t,n=o;a>n;n++)jAlbumLibrary.preloadImg(jAlbumGlobals.jAlbumURL+G+L[n].path)}function u(){if(""!==G){G=jAlbumLibrary.previousDir(G);var e=b(jAlbumGlobals.dataTree,G);c(),l(),p(e),g()}}function m(e){var t=$jAlbum.Event("clearUpContent");t.state=e,$jAlbum(window).trigger(t)}function c(){m(),S=new Array,L=new Array,k=new Array,""==G?$jAlbum(".leaveFolder").hide():$jAlbum(".leaveFolder").show()}function b(e,t){var o=t.substring(0,t.indexOf("/")),a=t.substring(t.indexOf("/")+1,t.length);return""==o?e:(objectToReturn=void 0,$jAlbum.each(e.objects,function(e,t){switch(t.category){case"folder":t.path==o&&(objectToReturn=t)}}),b(objectToReturn,a))}function d(e,t){for(var o=0,a=0;a<e.objects.length;a++)switch(e.objects[a].category){case"video":case"image":if(e.objects[a].name==t)return o;o++}return-1}function h(){var e=jAlbumLibrary.getHash().substr(1),t=e.substr(0,e.lastIndexOf("/")+1),o=e.substr(e.lastIndexOf("/")+1);G=t;var a=b(jAlbumGlobals.dataTree,t),n=d(a,o);p(a),-1!=n&&w(n),""!=G&&$jAlbum(".leaveFolder").show()}function p(e){var t=0;$jAlbum.each(e.objects,function(e,o){switch(o.category){case"folder":if(!o.objects)break;S[t]={index:t,name:o.name,path:o.thumb.path,width:o.thumb.width,height:o.thumb.height,count:o.deepCounters.total},j(t,o),t++}});var o=0;$jAlbum.each(e.objects,function(e,t){switch(t.category){case"image":k[o]={index:o,path:t.thumb.path,width:t.thumb.width,height:t.thumb.height},L[o]={index:o,name:t.name,category:t.category,path:t.image.path,width:t.image.width,height:t.image.height,description:t.comment},f(o,t),o++;break;case"video":k[o]={index:o,path:t.thumb.path,width:t.thumb.width,height:t.thumb.height},L[o]={index:o,name:t.name,category:t.category,path:t.original.path,videothumb:t.image.path,width:t.image.width,height:t.image.height,description:t.comment},f(o,t),o++}}),g()}function g(){for(var o,a,n,l,s,u,m,c,b=0;2>b;b++)o=e(),a=t(),n=.025*o,l=a-2*n,$jAlbum("#jAlbum-content").css("padding",""+n+"px 2.5%"),s=o-.05*o-.5,c=i(s),u=s/c,m=u-$,r(u);$jAlbum(".video_icon").css("padding",(u-50)/2),A(u,m),v(u,m)}function j(e,t){function a(){G=jAlbumLibrary.nextDir(G,t.path),c(),l(),p(t)}var n=$jAlbum("<div>",{"class":"main-box"}),i=$jAlbum("<div>",{"class":"wrapper-box"}),r=$jAlbum("<div>",{"class":"text-box"}),s=0;if(i.attr("id","test-box-"+e),i.css({"-webkit-transition":"0.2s ease-out","-moz-transition":"0.2s ease-out","-o-transition":"0.2s ease-out",transition:"0.2s ease-out"}),i.click(function(e){e.stopPropagation(),(e.target==e.currentTarget?u:a)()}),$jAlbum.each(t.objects,function(o,a){if(3>s)switch(a.category){case"image":var n=G+t.path+"/"+a.thumb.path,l=jAlbumLibrary.img("img-folder-"+s+"-"+e,jAlbumGlobals.jAlbumURL+n);l.addClass("shadow"),l.addClass("imgRadius"),l.addClass("fadein-"+(s+1)),l.prop("title",jAlbumLibrary.truncate(S[e].name,50)),$jAlbum(window).on("clearUpContent",function(e){l.remove()}),jAlbumGlobals.mobile||l.hover(function(){i.css({"-webkit-transform":jAlbumGlobals.imgHoverScaleFactor,"-moz-transform":jAlbumGlobals.imgHoverScaleFactor,"-o-transform":jAlbumGlobals.imgHoverScaleFactor,transform:jAlbumGlobals.imgHoverScaleFactor})},function(){i.css({"-webkit-transform":"scale(1)","-moz-transform":"scale(1)","-o-transform":"scale(1)",transform:"scale(1)"})}),i.append(l),s++}}),0==s){var m=$jAlbum("<img>");m.attr("src",jAlbumGlobals.jAlbumURL+"res/img/folder.png"),m.css("position","absolute"),jAlbumGlobals.showFolderName?(m.css("width","60%"),m.css("margin","20%")):(m.css("width","80%"),m.css("margin","10%")),m.prop("title",jAlbumLibrary.truncate(S[e].name,50)),m.addClass("emptyFolderThumbnail"),m.addClass("fadein-1"),$jAlbum(window).on("clearUpContent",function(e){m.remove()}),jAlbumGlobals.mobile||m.hover(function(){i.css({"-webkit-transform":jAlbumGlobals.imgHoverScaleFactor,"-moz-transform":jAlbumGlobals.imgHoverScaleFactor,"-o-transform":jAlbumGlobals.imgHoverScaleFactor,transform:jAlbumGlobals.imgHoverScaleFactor})},function(){i.css({"-webkit-transform":"scale(1)","-moz-transform":"scale(1)","-o-transform":"scale(1)",transform:"scale(1)"})}),i.append(m)}if(jAlbumGlobals.showFolderName){r.addClass("folderTitle");var b=o(),d=S[e].count?S[e].count:0;jAlbumGlobals.folderImgCount?r.append("<p>"+jAlbumLibrary.truncate(S[e].name,b)+" ("+d+")</p>"):r.append("<p>"+jAlbumLibrary.truncate(S[e].name,b+3)+"</p>"),r.click(function(e){e.stopPropagation(),e.target==e.currentTarget&&a()}),n.append(r)}n.append(i),$jAlbum("#jAlbum-content").append(n),$jAlbum(window).on("clearUpContent",function(e){e.stopPropagation(),n.remove()})}function A(e,t){jAlbumGlobals.folderTitleUp?($jAlbum(".text-box").css("padding-top","3px"),$jAlbum(".text-box").css("padding-left","5px")):($jAlbum(".text-box").css("padding-top",e-43+"px"),$jAlbum(".text-box").css("padding-left","5px")),t=jAlbumGlobals.showFolderName?.5*t:.8*t,$jAlbum.each(S,function(o,a){if(void 0!=a.width)for(var n=a.width,i=a.height,l=0;3>l;l++){var r=$jAlbum("#img-folder-"+l+"-"+a.index),s=-10*(l-1),u=-10*(l-1),m=0,c=0;r.css("transform","translate("+s+"px,"+u+"px)"),r.css("zIndex",20-l),n>=i?(m=t,c=i/(n/t)):(m=n/(i/t),c=t),r.css("width",m+"px"),r.css("height",c+"px"),r.css("margin",(e-c)/2-jAlbumGlobals.imgBorderSize+"px "+((e-m)/2-jAlbumGlobals.imgBorderSize)+"px")}})}function f(e,t){var o=$jAlbum("<div>",{"class":"main-box"}),a=jAlbumLibrary.img("img-thumb-"+e,jAlbumGlobals.jAlbumURL+G+t.thumb.path),n=$jAlbum("<div>",{"class":"video_icon_wrapper"});if("video"==t.category){var i=$jAlbum("<img>",{"class":"video_icon"});i.addClass("fadein-1"),i.attr("src",jAlbumGlobals.jAlbumURL+"res/img/play.png"),n.append(i)}a.css({"-webkit-transition":"0.2s ease-out","-moz-transition":"0.2s ease-out","-o-transition":"0.2s ease-out",transition:"0.2s ease-out"}),a.css("zIndex",5),a.addClass("shadow"),a.addClass("imgRadius"),a.addClass("img-box"),a.addClass("fadein-1");var l=void 0==L[e].description?"":L[e].description;a.prop("title",jAlbumLibrary.truncate(l,100)),jAlbumGlobals.mobile||a.hover(function(){a.css("zIndex",10),a.css({"-webkit-transform":jAlbumGlobals.imgHoverScaleFactor,"-moz-transform":jAlbumGlobals.imgHoverScaleFactor,"-o-transform":jAlbumGlobals.imgHoverScaleFactor,transform:jAlbumGlobals.imgHoverScaleFactor})},function(){a.css("zIndex",5),a.css({"-webkit-transform":"scale(1)","-moz-transform":"scale(1)","-o-transform":"scale(1)",transform:"scale(1)"})}),o.click(function(t){t.stopPropagation(),t.target==t.currentTarget?u():w(e)}),o.append(a),"video"==t.category&&o.append(n),$jAlbum("#jAlbum-content").append(o),$jAlbum(window).on("clearUpContent",function(e){o.remove()})}function v(e,t){$jAlbum.each(k,function(o,a){var n=a.width,i=a.height,l=0,r=0,s=$jAlbum("#img-thumb-"+a.index),u=$jAlbum(".video_icon_wrapper");n>=i?(l=t,r=t*i/n):(l=t*n/i,r=t),s.css("width",l+"px"),s.css("height",r+"px"),u.css("width",e+"px"),u.css("height",e+"px"),s.css("margin",(e-r)/2-jAlbumGlobals.imgBorderSize+"px "+((e-l)/2-jAlbumGlobals.imgBorderSize)+"px")})}function w(e){function t(){var t=L.length,o=e+1;0>o?o+=t:o>=t&&(o-=t),r.remove(),n.remove(),c.remove(),d.css("display","none"),h.css({overflowY:"visible",height:"auto"}),C=null,w(o)}function o(){var t=L.length,o=e-1;0>o?o+=t:o>=t&&(o-=t),r.remove(),n.remove(),c.remove(),d.css("display","none"),h.css({overflowY:"visible",height:"auto"}),C=null,w(o)}function a(){d.css("display","none"),h.css({overflowY:"visible",height:"auto"}),r.remove(),n.remove(),c.remove(),C=null,l(),g()}l(L[e].name);var n,i=(L[e].width,L[e].height,G+L[e].path),r=($jAlbum(window).width(),$jAlbum(window).height(),$jAlbum("<div/>")),u=$jAlbum("<div/>"),m=$jAlbum("<div/>"),c="video"==L[e].category?$jAlbum("<img src='"+jAlbumGlobals.jAlbumURL+G+L[e].videothumb+"'>"):$jAlbum("<img>"),b=$jAlbum("<div/>");jAlbumGlobals.showComments||b.hide(),c.css({width:"100%",height:"100%",position:"absolute"}),jAlbumGlobals.mobile||c.css("opacity","0"),b.unbind();var d=$jAlbum("#fullscreen"),h=$jAlbum("#Responsive");switch(C=e,h.css({overflowY:"hidden",height:"100%"}),d.css("display","block"),r.addClass("fs_box"),u.addClass("cancel"),m.addClass("play"),c.addClass("video_thumbnail"),b.addClass("fs_desc"),void 0!=L[e].description&&b.append("<p>"+L[e].description+"</p>"),L[e].category){case"image":n=jAlbumLibrary.img("img-fullscreen-"+e,jAlbumGlobals.jAlbumURL+i),m.hide();break;case"video":n=jAlbumLibrary.vid("img-fullscreen-"+e,jAlbumGlobals.jAlbumURL+i),m.show()}"video"==L[e].category&&n.on("ended",function(){m.show(),c.show()}),d.click(function(e){e.stopPropagation(),e.target==e.currentTarget&&a()}),u.click(function(e){e.stopPropagation(),e.target==e.currentTarget&&a()}),m.click(function(t){t.stopPropagation(),t.target==t.currentTarget&&(document.getElementById("img-fullscreen-"+e).play(),m.hide(),c.hide())}),d.swipe({swipe:function(e,t){}}),r.swipe({tap:function(o,a){o.target==o.currentTarget&&("video"!=L[e].category||n.get(0).paused?t():(n.get(0).pause(),m.show(),c.show()))},longTap:function(e,t){e.target==e.currentTarget&&a()},swipe:function(e,n,i,l,r,s){switch(n){case"left":e.target==e.currentTarget&&t();break;case"right":e.target==e.currentTarget&&o();break;case"up":e.target==e.currentTarget&&a();case"down":e.target==e.currentTarget&&a()}}}),$jAlbum(document).off().keyup(function(e){39==e.keyCode?t():37==e.keyCode?o():27==e.keyCode&&a()}),r.append(u),r.append(m),r.append(b),d.append(c),d.append(r),d.append(n),x(),s(e,2)}function x(){if(null!==C){var e=L[C].width,t=L[C].height,o=$jAlbum(window).width(),a=$jAlbum(window).height(),n=0,i=0,l=$jAlbum("#fullscreen img, #fullscreen video, #fullscreen .fs_box, #fullscreen .video_thumbnail");o/a>=e/t?(n=e/(t/a),i=a,l.css("margin","0px "+(o-n)/2+"px")):(n=o,i=t/(e/o),l.css("margin",(a-i)/2+"px 0px")),l.css("height",i),l.css("width",n);var r=(n-$jAlbum(".fs_desc").width())/2;r=0>r?0:r,$jAlbum(".fs_desc").css("margin","0px "+r+"px")}}var $=a(),y=n(),G="",C=null,k=new Array,L=new Array,S=new Array;return $jAlbum.mobile.hashListeningEnabled=!1,$jAlbum(document).bind("mobileinit",function(){$jAlbum.mobile.changePage.defaults.changeHash=!1,$jAlbum.mobile.hashListeningEnabled=!1,$jAlbum.mobile.pushStateEnabled=!1}),$jAlbum(document).ready(function(){$jAlbum(".ui-loader").hide()}),""==G&&$jAlbum(".leaveFolder").hide(),jAlbumGlobals.credits||$jAlbum("#jAlbum-footer .center").hide(),$jAlbum("#Responsive, .jAlbum #jAlbum-footer, .jAlbum #jAlbum-footer .center, .jAlbum #jAlbum-footer .left, .jAlbum #jAlbum-footer p, .jAlbum #jAlbum-content, .jAlbum #print").click(function(e){e.target==e.currentTarget&&u()}),window.onresize=function(){g(),x()},{init:h,back:u}}();jAlbumController.init();